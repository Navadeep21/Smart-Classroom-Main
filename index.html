<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Classroom & Timetable Scheduler</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        .animate-fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .notification { animation: slideIn 0.5s ease-out; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
        .role-card { background: linear-gradient(145deg, #f0f9ff, #e0f2fe); }
        .teacher-theme { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); }
        .student-theme { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Role Selection Page -->
    <div id="role-selection" class="min-h-screen gradient-bg flex items-center justify-center">
        <div class="text-center animate-fade-in">
            <div class="mb-8">
                <i class="fas fa-graduation-cap text-6xl text-white mb-4"></i>
                <h1 class="text-4xl font-bold text-white mb-2">Smart Classroom System</h1>
                <p class="text-xl text-white opacity-90">Choose your role to continue</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-2xl">
                <div class="role-card p-8 rounded-2xl shadow-xl card-hover cursor-pointer" onclick="selectRole('teacher')">
                    <i class="fas fa-chalkboard-teacher text-5xl text-orange-500 mb-4"></i>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Teacher</h3>
                    <p class="text-gray-600 mb-4">Manage classrooms, schedule classes, and create timetables</p>
                    <div class="text-sm text-gray-500">
                        <i class="fas fa-check mr-2"></i>Book Classrooms<br>
                        <i class="fas fa-check mr-2"></i>Schedule Classes<br>
                        <i class="fas fa-check mr-2"></i>Manage Timetable
                    </div>
                </div>
                
                <div class="role-card p-8 rounded-2xl shadow-xl card-hover cursor-pointer" onclick="selectRole('student')">
                    <i class="fas fa-user-graduate text-5xl text-blue-500 mb-4"></i>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Student</h3>
                    <p class="text-gray-600 mb-4">View your schedule, get notifications, and track classes</p>
                    <div class="text-sm text-gray-500">
                        <i class="fas fa-check mr-2"></i>View Schedule<br>
                        <i class="fas fa-check mr-2"></i>Get Notifications<br>
                        <i class="fas fa-check mr-2"></i>Track Attendance
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login/Register Page -->
    <div id="auth-page" class="min-h-screen gradient-bg flex items-center justify-center hidden">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md animate-fade-in">
            <div class="text-center mb-8">
                <div id="auth-icon" class="text-5xl mb-4"></div>
                <h2 id="auth-title" class="text-3xl font-bold text-gray-800 mb-2"></h2>
                <p id="auth-subtitle" class="text-gray-600"></p>
            </div>

            <!-- Login Form -->
            <form id="login-form" class="space-y-6">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Email</label>
                    <input type="email" id="login-email" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your email" required>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Password</label>
                    <input type="password" id="login-password" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your password" required>
                </div>
                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold transition">
                    <i class="fas fa-sign-in-alt mr-2"></i>Login
                </button>
            </form>

            <!-- Register Form -->
            <form id="register-form" class="space-y-6 hidden">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Full Name</label>
                    <input type="text" id="register-name" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your full name" required>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Email</label>
                    <input type="email" id="register-email" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your email" required>
                </div>
                <div id="student-class-section" class="hidden">
                    <label class="block text-gray-700 font-semibold mb-2">Select Your Class</label>
                    <select id="student-class" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Choose your class</option>
                        <option value="Computer Science">Computer Science</option>
                        <option value="Mathematics">Mathematics</option>
                        <option value="Physics">Physics</option>
                        <option value="Chemistry">Chemistry</option>
                        <option value="English Literature">English Literature</option>
                        <option value="History">History</option>
                        <option value="Economics">Economics</option>
                    </select>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Password</label>
                    <input type="password" id="register-password" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Create a password" required>
                </div>
                <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-semibold transition">
                    <i class="fas fa-user-plus mr-2"></i>Register
                </button>
            </form>

            <div class="mt-6 text-center">
                <p class="text-gray-600">
                    <span id="toggle-text">Don't have an account?</span>
                    <button id="toggle-form" class="text-blue-600 hover:text-blue-700 font-semibold ml-1">Register here</button>
                </p>
                <button onclick="backToRoleSelection()" class="text-gray-500 hover:text-gray-700 mt-2 text-sm">
                    <i class="fas fa-arrow-left mr-1"></i>Back to role selection
                </button>
            </div>
        </div>
    </div>

    <!-- Teacher Dashboard -->
    <div id="teacher-dashboard" class="hidden">
        <!-- Teacher Navigation -->
        <nav class="teacher-theme text-white shadow-lg">
            <div class="container mx-auto px-4 py-3">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-chalkboard-teacher text-2xl"></i>
                        <h1 class="text-xl font-bold">Teacher Dashboard</h1>
                    </div>
                    <div class="hidden md:flex space-x-6">
                        <button onclick="showTeacherSection('teacher-home')" class="teacher-nav-btn hover:bg-white hover:bg-opacity-20 px-3 py-2 rounded transition">
                            <i class="fas fa-home mr-1"></i> Home
                        </button>
                        <button onclick="showTeacherSection('schedule-class')" class="teacher-nav-btn hover:bg-white hover:bg-opacity-20 px-3 py-2 rounded transition">
                            <i class="fas fa-calendar-plus mr-1"></i> Schedule Class
                        </button>
                        <button onclick="showTeacherSection('my-schedule')" class="teacher-nav-btn hover:bg-white hover:bg-opacity-20 px-3 py-2 rounded transition">
                            <i class="fas fa-calendar-alt mr-1"></i> My Schedule
                        </button>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="hidden md:block" id="teacher-name">Welcome, Teacher</span>
                        <button onclick="logout()" class="text-white hover:bg-white hover:bg-opacity-20 px-3 py-2 rounded transition">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Teacher Home -->
        <section id="teacher-home" class="teacher-section">
            <div class="container mx-auto px-4 py-8">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">Teacher Dashboard</h2>
                    <p class="text-xl text-gray-600">Manage your classes and schedules efficiently</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-xl shadow-lg card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">Today's Classes</p>
                                <p class="text-3xl font-bold text-gray-800" id="today-classes">0</p>
                            </div>
                            <i class="fas fa-calendar-day text-4xl text-blue-500"></i>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">Total Students</p>
                                <p class="text-3xl font-bold text-gray-800" id="total-students">0</p>
                            </div>
                            <i class="fas fa-users text-4xl text-green-500"></i>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">Upcoming Classes</p>
                                <p class="text-3xl font-bold text-gray-800" id="upcoming-classes">0</p>
                            </div>
                            <i class="fas fa-clock text-4xl text-orange-500"></i>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-xl font-semibold mb-4">Quick Actions</h3>
                        <div class="space-y-3">
                            <button onclick="showTeacherSection('schedule-class')" class="w-full bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-lg transition text-left">
                                <i class="fas fa-plus mr-2"></i>Schedule New Class
                            </button>
                            <button onclick="showTeacherSection('my-schedule')" class="w-full bg-green-500 hover:bg-green-600 text-white p-3 rounded-lg transition text-left">
                                <i class="fas fa-eye mr-2"></i>View My Schedule
                            </button>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-xl font-semibold mb-4">Recent Activity</h3>
                        <div id="teacher-recent-activity" class="space-y-3">
                            <p class="text-gray-500 text-sm">No recent activity</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Schedule Class -->
        <section id="schedule-class" class="teacher-section hidden">
            <div class="container mx-auto px-4 py-8">
                <div class="max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">
                        <i class="fas fa-calendar-plus text-blue-500 mr-2"></i>Schedule New Class
                    </h2>

                    <form id="class-schedule-form" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Subject</label>
                                <select id="class-subject" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                    <option value="">Select Subject</option>
                                    <option value="Computer Science">Computer Science</option>
                                    <option value="Mathematics">Mathematics</option>
                                    <option value="Physics">Physics</option>
                                    <option value="Chemistry">Chemistry</option>
                                    <option value="English Literature">English Literature</option>
                                    <option value="History">History</option>
                                    <option value="Economics">Economics</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Room</label>
                                <select id="class-room" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                    <option value="">Select Room</option>
                                    <option value="A101">Room A101</option>
                                    <option value="B202">Room B202</option>
                                    <option value="C303">Room C303</option>
                                    <option value="D404">Room D404</option>
                                    <option value="E505">Room E505</option>
                                </select>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Date</label>
                                <input type="date" id="class-date" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            </div>
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Duration</label>
                                <select id="class-duration" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                    <option value="">Select Duration</option>
                                    <option value="09:00-10:00">9:00 AM - 10:00 AM</option>
                                    <option value="10:00-11:00">10:00 AM - 11:00 AM</option>
                                    <option value="11:00-12:00">11:00 AM - 12:00 PM</option>
                                    <option value="12:00-13:00">12:00 PM - 1:00 PM</option>
                                    <option value="14:00-15:00">2:00 PM - 3:00 PM</option>
                                    <option value="15:00-16:00">3:00 PM - 4:00 PM</option>
                                    <option value="16:00-17:00">4:00 PM - 5:00 PM</option>
                                </select>
                            </div>
                        </div>

                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Class Description (Optional)</label>
                            <textarea id="class-description" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter class description or topic"></textarea>
                        </div>

                        <button type="submit" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg font-semibold transition">
                            <i class="fas fa-calendar-plus mr-2"></i>Schedule Class
                        </button>
                    </form>
                </div>
            </div>
        </section>

        <!-- My Schedule -->
        <section id="my-schedule" class="teacher-section hidden">
            <div class="container mx-auto px-4 py-8">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-calendar-alt text-blue-500 mr-2"></i>My Schedule
                    </h2>

                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse" id="teacher-schedule-table">
                            <thead>
                                <tr class="teacher-theme text-white">
                                    <th class="border border-gray-300 p-3 text-left">Date</th>
                                    <th class="border border-gray-300 p-3 text-left">Time</th>
                                    <th class="border border-gray-300 p-3 text-left">Subject</th>
                                    <th class="border border-gray-300 p-3 text-left">Room</th>
                                    <th class="border border-gray-300 p-3 text-left">Description</th>
                                    <th class="border border-gray-300 p-3 text-left">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="teacher-schedule-body">
                                <!-- Schedule will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Student Dashboard -->
    <div id="student-dashboard" class="hidden">
        <!-- Student Navigation -->
        <nav class="student-theme text-white shadow-lg">
            <div class="container mx-auto px-4 py-3">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-user-graduate text-2xl"></i>
                        <h1 class="text-xl font-bold">Student Dashboard</h1>
                    </div>
                    <div class="hidden md:flex space-x-6">
                        <button onclick="showStudentSection('student-home')" class="student-nav-btn hover:bg-white hover:bg-opacity-20 px-3 py-2 rounded transition">
                            <i class="fas fa-home mr-1"></i> Home
                        </button>
                        <button onclick="showStudentSection('my-classes')" class="student-nav-btn hover:bg-white hover:bg-opacity-20 px-3 py-2 rounded transition">
                            <i class="fas fa-calendar-alt mr-1"></i> My Classes
                        </button>
                        <button onclick="showStudentSection('notifications')" class="student-nav-btn hover:bg-white hover:bg-opacity-20 px-3 py-2 rounded transition relative">
                            <i class="fas fa-bell mr-1"></i> Notifications
                            <span id="notification-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">0</span>
                        </button>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="hidden md:block" id="student-name">Welcome, Student</span>
                        <button onclick="logout()" class="text-white hover:bg-white hover:bg-opacity-20 px-3 py-2 rounded transition">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Student Home -->
        <section id="student-home" class="student-section">
            <div class="container mx-auto px-4 py-8">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">Student Dashboard</h2>
                    <p class="text-xl text-gray-600">Stay updated with your class schedule</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-xl shadow-lg card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">Today's Classes</p>
                                <p class="text-3xl font-bold text-gray-800" id="student-today-classes">0</p>
                            </div>
                            <i class="fas fa-calendar-day text-4xl text-blue-500"></i>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">My Subject</p>
                                <p class="text-lg font-bold text-gray-800" id="student-subject">-</p>
                            </div>
                            <i class="fas fa-book text-4xl text-green-500"></i>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">New Notifications</p>
                                <p class="text-3xl font-bold text-gray-800" id="student-notifications">0</p>
                            </div>
                            <i class="fas fa-bell text-4xl text-orange-500"></i>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-xl font-semibold mb-4">Today's Schedule</h3>
                        <div id="student-today-schedule" class="space-y-3">
                            <p class="text-gray-500 text-sm">No classes today</p>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-xl font-semibold mb-4">Recent Notifications</h3>
                        <div id="student-recent-notifications" class="space-y-3">
                            <p class="text-gray-500 text-sm">No new notifications</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- My Classes -->
        <section id="my-classes" class="student-section hidden">
            <div class="container mx-auto px-4 py-8">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-calendar-alt text-blue-500 mr-2"></i>My Classes
                    </h2>

                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse" id="student-schedule-table">
                            <thead>
                                <tr class="student-theme text-white">
                                    <th class="border border-gray-300 p-3 text-left">Date</th>
                                    <th class="border border-gray-300 p-3 text-left">Time</th>
                                    <th class="border border-gray-300 p-3 text-left">Subject</th>
                                    <th class="border border-gray-300 p-3 text-left">Room</th>
                                    <th class="border border-gray-300 p-3 text-left">Description</th>
                                    <th class="border border-gray-300 p-3 text-left">Status</th>
                                </tr>
                            </thead>
                            <tbody id="student-schedule-body">
                                <!-- Schedule will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Notifications -->
        <section id="notifications" class="student-section hidden">
            <div class="container mx-auto px-4 py-8">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-bell text-blue-500 mr-2"></i>Notifications
                    </h2>

                    <div id="notification-list" class="space-y-4">
                        <p class="text-gray-500 text-center py-8">No notifications yet</p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="text-center">
                <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4">
                    <i class="fas fa-check text-green-600 text-xl"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2" id="modal-title">Success!</h3>
                <p class="text-gray-600 mb-6" id="modal-message">Operation completed successfully.</p>
                <button onclick="closeModal()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg transition">
                    Close
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let currentRole = '';
        let currentUser = null;
        let users = {
            teachers: [
                { id: 1, name: 'Dr. Smith', email: 'smith@college.edu', password: 'teacher123' }
            ],
            students: [
                { id: 1, name: 'John Doe', email: 'john@college.edu', password: 'student123', class: 'Computer Science' }
            ]
        };
        let classes = [];
        let notifications = [];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setMinDate();
            setupEventListeners();
            showRoleSelection();
        });

        function setupEventListeners() {
            // Login form
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                login();
            });

            // Register form
            document.getElementById('register-form').addEventListener('submit', function(e) {
                e.preventDefault();
                register();
            });

            // Toggle between login and register
            document.getElementById('toggle-form').addEventListener('click', function() {
                toggleAuthForm();
            });

            // Class schedule form
            document.getElementById('class-schedule-form').addEventListener('submit', function(e) {
                e.preventDefault();
                scheduleClass();
            });
        }

        // Role Selection Functions
        function showRoleSelection() {
            document.getElementById('role-selection').classList.remove('hidden');
            document.getElementById('auth-page').classList.add('hidden');
            document.getElementById('teacher-dashboard').classList.add('hidden');
            document.getElementById('student-dashboard').classList.add('hidden');
        }

        function selectRole(role) {
            currentRole = role;
            document.getElementById('role-selection').classList.add('hidden');
            document.getElementById('auth-page').classList.remove('hidden');
            
            // Update auth page based on role
            if (role === 'teacher') {
                document.getElementById('auth-icon').innerHTML = '<i class="fas fa-chalkboard-teacher text-orange-500"></i>';
                document.getElementById('auth-title').textContent = 'Teacher Login';
                document.getElementById('auth-subtitle').textContent = 'Access your teaching dashboard';
                document.getElementById('student-class-section').classList.add('hidden');
            } else {
                document.getElementById('auth-icon').innerHTML = '<i class="fas fa-user-graduate text-blue-500"></i>';
                document.getElementById('auth-title').textContent = 'Student Login';
                document.getElementById('auth-subtitle').textContent = 'Access your class schedule';
            }
        }

        function backToRoleSelection() {
            showRoleSelection();
            resetAuthForms();
        }

        function resetAuthForms() {
            document.getElementById('login-form').classList.remove('hidden');
            document.getElementById('register-form').classList.add('hidden');
            document.getElementById('toggle-text').textContent = "Don't have an account?";
            document.getElementById('toggle-form').textContent = 'Register here';
            
            // Clear form fields
            document.getElementById('login-form').reset();
            document.getElementById('register-form').reset();
        }

        function toggleAuthForm() {
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const toggleText = document.getElementById('toggle-text');
            const toggleButton = document.getElementById('toggle-form');
            
            if (loginForm.classList.contains('hidden')) {
                // Show login form
                loginForm.classList.remove('hidden');
                registerForm.classList.add('hidden');
                toggleText.textContent = "Don't have an account?";
                toggleButton.textContent = 'Register here';
                
                if (currentRole === 'teacher') {
                    document.getElementById('auth-title').textContent = 'Teacher Login';
                } else {
                    document.getElementById('auth-title').textContent = 'Student Login';
                }
            } else {
                // Show register form
                loginForm.classList.add('hidden');
                registerForm.classList.remove('hidden');
                toggleText.textContent = "Already have an account?";
                toggleButton.textContent = 'Login here';
                
                if (currentRole === 'teacher') {
                    document.getElementById('auth-title').textContent = 'Teacher Registration';
                    document.getElementById('student-class-section').classList.add('hidden');
                } else {
                    document.getElementById('auth-title').textContent = 'Student Registration';
                    document.getElementById('student-class-section').classList.remove('hidden');
                }
            }
        }

        // Authentication Functions
        function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            let user = null;
            if (currentRole === 'teacher') {
                user = users.teachers.find(t => t.email === email && t.password === password);
            } else {
                user = users.students.find(s => s.email === email && s.password === password);
            }
            
            if (user) {
                currentUser = user;
                showDashboard();
                showModal('Login Successful', `Welcome back, ${user.name}!`);
            } else {
                alert('Invalid email or password!');
            }
        }

        function register() {
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const studentClass = document.getElementById('student-class').value;
            
            // Check if user already exists
            const existingUser = currentRole === 'teacher' 
                ? users.teachers.find(t => t.email === email)
                : users.students.find(s => s.email === email);
                
            if (existingUser) {
                alert('User with this email already exists!');
                return;
            }
            
            // Validate student class selection
            if (currentRole === 'student' && !studentClass) {
                alert('Please select your class!');
                return;
            }
            
            // Create new user
            const newUser = {
                id: Date.now(),
                name: name,
                email: email,
                password: password
            };
            
            if (currentRole === 'teacher') {
                users.teachers.push(newUser);
            } else {
                newUser.class = studentClass;
                users.students.push(newUser);
            }
            
            currentUser = newUser;
            showDashboard();
            showModal('Registration Successful', `Welcome, ${name}! Your account has been created.`);
        }

        function logout() {
            currentUser = null;
            currentRole = '';
            showRoleSelection();
            resetAuthForms();
        }

        // Dashboard Functions
        function showDashboard() {
            document.getElementById('auth-page').classList.add('hidden');
            
            if (currentRole === 'teacher') {
                document.getElementById('teacher-dashboard').classList.remove('hidden');
                document.getElementById('teacher-name').textContent = `Welcome, ${currentUser.name}`;
                showTeacherSection('teacher-home');
                updateTeacherStats();
            } else {
                document.getElementById('student-dashboard').classList.remove('hidden');
                document.getElementById('student-name').textContent = `Welcome, ${currentUser.name}`;
                document.getElementById('student-subject').textContent = currentUser.class;
                showStudentSection('student-home');
                updateStudentStats();
            }
        }

        function showTeacherSection(sectionId) {
            // Hide all teacher sections
            const teacherSections = document.querySelectorAll('.teacher-section');
            teacherSections.forEach(section => section.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(sectionId).classList.remove('hidden');
            
            // Update nav buttons
            const navButtons = document.querySelectorAll('.teacher-nav-btn');
            navButtons.forEach(btn => btn.classList.remove('bg-white', 'bg-opacity-20'));
            event.target.closest('.teacher-nav-btn').classList.add('bg-white', 'bg-opacity-20');
            
            // Load section-specific content
            if (sectionId === 'my-schedule') {
                loadTeacherSchedule();
            }
        }

        function showStudentSection(sectionId) {
            // Hide all student sections
            const studentSections = document.querySelectorAll('.student-section');
            studentSections.forEach(section => section.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(sectionId).classList.remove('hidden');
            
            // Update nav buttons
            const navButtons = document.querySelectorAll('.student-nav-btn');
            navButtons.forEach(btn => btn.classList.remove('bg-white', 'bg-opacity-20'));
            event.target.closest('.student-nav-btn').classList.add('bg-white', 'bg-opacity-20');
            
            // Load section-specific content
            if (sectionId === 'my-classes') {
                loadStudentSchedule();
            } else if (sectionId === 'notifications') {
                loadNotifications();
            }
        }

        // Class Scheduling Functions
        function scheduleClass() {
            const subject = document.getElementById('class-subject').value;
            const room = document.getElementById('class-room').value;
            const date = document.getElementById('class-date').value;
            const duration = document.getElementById('class-duration').value;
            const description = document.getElementById('class-description').value;
            
            // Check for conflicts
            const conflict = classes.find(c => 
                c.room === room && c.date === date && c.duration === duration
            );
            
            if (conflict) {
                alert('Room is already booked for this time slot!');
                return;
            }
            
            // Create new class
            const newClass = {
                id: Date.now(),
                subject: subject,
                room: room,
                date: date,
                duration: duration,
                description: description,
                teacherId: currentUser.id,
                teacherName: currentUser.name
            };
            
            classes.push(newClass);
            
            // Send notification to students of the same subject
            sendNotificationToStudents(newClass);
            
            // Reset form
            document.getElementById('class-schedule-form').reset();
            
            showModal('Class Scheduled', `${subject} has been scheduled for ${date} from ${duration} in ${room}`);
            updateTeacherStats();
        }

        function sendNotificationToStudents(classInfo) {
            const relevantStudents = users.students.filter(student => 
                student.class === classInfo.subject
            );
            
            relevantStudents.forEach(student => {
                const notification = {
                    id: Date.now() + Math.random(),
                    studentId: student.id,
                    title: 'New Class Scheduled',
                    message: `${classInfo.subject} class scheduled for ${classInfo.date} from ${classInfo.duration} in room ${classInfo.room}`,
                    classInfo: classInfo,
                    timestamp: new Date(),
                    read: false
                };
                notifications.push(notification);
            });
            
            // Update notification badge if current user is a student
            if (currentRole === 'student') {
                updateNotificationBadge();
            }
        }

        // Stats and Data Functions
        function updateTeacherStats() {
            const today = new Date().toISOString().split('T')[0];
            const teacherClasses = classes.filter(c => c.teacherId === currentUser.id);
            const todayClasses = teacherClasses.filter(c => c.date === today);
            const upcomingClasses = teacherClasses.filter(c => new Date(c.date) > new Date());
            
            document.getElementById('today-classes').textContent = todayClasses.length;
            document.getElementById('upcoming-classes').textContent = upcomingClasses.length;
            
            // Calculate total students (assuming average class size)
            const totalStudents = teacherClasses.length * 30; // Estimate
            document.getElementById('total-students').textContent = totalStudents;
            
            // Update recent activity
            const recentActivity = document.getElementById('teacher-recent-activity');
            if (teacherClasses.length > 0) {
                const recentClass = teacherClasses[teacherClasses.length - 1];
                recentActivity.innerHTML = `
                    <div class="p-3 bg-blue-50 rounded-lg">
                        <p class="text-sm font-semibold">Recently scheduled:</p>
                        <p class="text-xs text-gray-600">${recentClass.subject} - ${recentClass.date} ${recentClass.duration}</p>
                    </div>
                `;
            }
        }

        function updateStudentStats() {
            const today = new Date().toISOString().split('T')[0];
            const studentClasses = classes.filter(c => c.subject === currentUser.class);
            const todayClasses = studentClasses.filter(c => c.date === today);
            
            document.getElementById('student-today-classes').textContent = todayClasses.length;
            
            // Update notification count
            const studentNotifications = notifications.filter(n => 
                n.studentId === currentUser.id && !n.read
            );
            document.getElementById('student-notifications').textContent = studentNotifications.length;
            updateNotificationBadge();
            
            // Update today's schedule
            const todaySchedule = document.getElementById('student-today-schedule');
            if (todayClasses.length > 0) {
                todaySchedule.innerHTML = todayClasses.map(c => `
                    <div class="p-3 bg-blue-50 rounded-lg">
                        <div class="font-semibold">${c.subject}</div>
                        <div class="text-sm text-gray-600">${c.duration} - Room ${c.room}</div>
                        <div class="text-xs text-gray-500">${c.description || 'No description'}</div>
                    </div>
                `).join('');
            } else {
                todaySchedule.innerHTML = '<p class="text-gray-500 text-sm">No classes today</p>';
            }
            
            // Update recent notifications
            const recentNotifications = document.getElementById('student-recent-notifications');
            const recent = studentNotifications.slice(0, 3);
            if (recent.length > 0) {
                recentNotifications.innerHTML = recent.map(n => `
                    <div class="p-3 bg-green-50 rounded-lg">
                        <div class="font-semibold text-sm">${n.title}</div>
                        <div class="text-xs text-gray-600">${n.message}</div>
                    </div>
                `).join('');
            }
        }

        function updateNotificationBadge() {
            if (currentRole === 'student') {
                const unreadCount = notifications.filter(n => 
                    n.studentId === currentUser.id && !n.read
                ).length;
                
                const badge = document.getElementById('notification-badge');
                if (unreadCount > 0) {
                    badge.textContent = unreadCount;
                    badge.classList.remove('hidden');
                } else {
                    badge.classList.add('hidden');
                }
            }
        }

        // Schedule Loading Functions
        function loadTeacherSchedule() {
            const tbody = document.getElementById('teacher-schedule-body');
            const teacherClasses = classes.filter(c => c.teacherId === currentUser.id);
            
            if (teacherClasses.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="text-center p-4 text-gray-500">No classes scheduled</td></tr>';
                return;
            }
            
            tbody.innerHTML = teacherClasses.map(c => `
                <tr class="hover:bg-gray-50">
                    <td class="border border-gray-300 p-3">${c.date}</td>
                    <td class="border border-gray-300 p-3">${c.duration}</td>
                    <td class="border border-gray-300 p-3">${c.subject}</td>
                    <td class="border border-gray-300 p-3">${c.room}</td>
                    <td class="border border-gray-300 p-3">${c.description || '-'}</td>
                    <td class="border border-gray-300 p-3">
                        <button onclick="deleteClass(${c.id})" class="text-red-500 hover:text-red-700">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function loadStudentSchedule() {
            const tbody = document.getElementById('student-schedule-body');
            const studentClasses = classes.filter(c => c.subject === currentUser.class);
            
            if (studentClasses.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="text-center p-4 text-gray-500">No classes scheduled</td></tr>';
                return;
            }
            
            tbody.innerHTML = studentClasses.map(c => {
                const isPast = new Date(c.date) < new Date();
                const status = isPast ? 'Completed' : 'Upcoming';
                const statusClass = isPast ? 'text-gray-500' : 'text-green-600';
                
                return `
                    <tr class="hover:bg-gray-50">
                        <td class="border border-gray-300 p-3">${c.date}</td>
                        <td class="border border-gray-300 p-3">${c.duration}</td>
                        <td class="border border-gray-300 p-3">${c.subject}</td>
                        <td class="border border-gray-300 p-3">${c.room}</td>
                        <td class="border border-gray-300 p-3">${c.description || '-'}</td>
                        <td class="border border-gray-300 p-3 ${statusClass}">${status}</td>
                    </tr>
                `;
            }).join('');
        }

        function loadNotifications() {
            const container = document.getElementById('notification-list');
            const studentNotifications = notifications.filter(n => n.studentId === currentUser.id);
            
            if (studentNotifications.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">No notifications yet</p>';
                return;
            }
            
            container.innerHTML = studentNotifications.map(n => {
                const timeAgo = getTimeAgo(n.timestamp);
                return `
                    <div class="border rounded-lg p-4 ${n.read ? 'bg-gray-50' : 'bg-blue-50'} notification">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-semibold ${n.read ? 'text-gray-800' : 'text-blue-800'}">${n.title}</h4>
                                <p class="text-gray-600 mt-1">${n.message}</p>
                                <p class="text-xs text-gray-500 mt-2">${timeAgo}</p>
                            </div>
                            ${!n.read ? '<div class="w-2 h-2 bg-blue-500 rounded-full mt-1 ml-2"></div>' : ''}
                        </div>
                    </div>
                `;
            }).join('');
            
            // Mark notifications as read
            studentNotifications.forEach(n => n.read = true);
            updateNotificationBadge();
        }

        // Utility Functions
        function deleteClass(classId) {
            if (confirm('Are you sure you want to delete this class?')) {
                classes = classes.filter(c => c.id !== classId);
                loadTeacherSchedule();
                updateTeacherStats();
                showModal('Class Deleted', 'The class has been removed from the schedule.');
            }
        }

        function setMinDate() {
            const today = new Date().toISOString().split('T')[0];
            const dateInput = document.getElementById('class-date');
            if (dateInput) {
                dateInput.min = today;
            }
        }

        function getTimeAgo(timestamp) {
            const now = new Date();
            const time = new Date(timestamp);
            const diffInSeconds = Math.floor((now - time) / 1000);
            
            if (diffInSeconds < 60) return 'Just now';
            if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)} minutes ago`;
            if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)} hours ago`;
            return `${Math.floor(diffInSeconds / 86400)} days ago`;
        }

        function showModal(title, message) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-message').textContent = message;
            document.getElementById('success-modal').classList.remove('hidden');
            document.getElementById('success-modal').classList.add('flex');
        }

        function closeModal() {
            document.getElementById('success-modal').classList.add('hidden');
            document.getElementById('success-modal').classList.remove('flex');
        }